{"remainingRequest":"D:\\Vue项目\\restaurant_p\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Vue项目\\restaurant_p\\src\\components\\order.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Vue项目\\restaurant_p\\src\\components\\order.vue","mtime":1585838757925},{"path":"D:\\Vue项目\\restaurant_p\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Vue项目\\restaurant_p\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Vue项目\\restaurant_p\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Vue项目\\restaurant_p\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHN0YXRlOiBbDQogICAgICAgIHsNCiAgICAgICAgICB2YWx1ZTogMiwNCiAgICAgICAgICBsYWJlbDogIuetieW+heS4iuiPnCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHZhbHVlOiAzLA0KICAgICAgICAgIGxhYmVsOiAi5bey5a6M5oiQIg0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgb3JkZXI6ICIiLA0KICAgICAgb3JkZXJUYWJsZTogW10NCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZWRpdFN0YXRlKGlkKSB7DQogICAgICB0aGlzLiRheGlvcy5kZWZhdWx0cy5oZWFkZXJzLnBvc3RbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iOw0KICAgICAgdGhpcy4kYXhpb3MNCiAgICAgICAgLnBvc3QodGhpcy4kc3RvcmUuc3RhdGUuaHR0cFVybCArICIvZWRpdE9yZGVyU3RhdHVzIiwgew0KICAgICAgICAgIG9yZGVyU3RhdHVzOiBwYXJzZUludCh0aGlzLm9yZGVyVGFibGVbaWRdLnN0YXRlKSwNCiAgICAgICAgICBpZDogdGhpcy5vcmRlclRhYmxlW2lkXS5vcmRlcklkDQogICAgICAgIH0pDQogICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpOw0KICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09PSAyMDAwMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIHR5cGU6ICJzdWNjZXNzIiwNCiAgICAgICAgICAgICAgbWVzc2FnZTogIuS/ruaUueeKtuaAgeaIkOWKn++8gSINCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwMDEpIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICB0eXBlOiAiZXJyb3IiLA0KICAgICAgICAgICAgICBtZXNzYWdlOiAi5L+u5pS554q25oCB5aSx6LSl77yM57O757uf6ZSZ6K+v77yBIg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmdldE1lbnUoKTsNCiAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMDAxKSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgbWVzc2FnZTogIuS/ruaUueeKtuaAgeWksei0pe+8jOeZu+W9lei/h+acn++8jOivt+mHjeaWsOeZu+W9le+8gSINCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhpcy5nZXRNZW51KCk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGRlbGV0ZU9yZGVyKGlkLCByb3dzKSB7DQogICAgICB0aGlzLiRjb25maXJtKCLmmK/lkKbnoa7lrprliKDpmaTmraTorqLljZXvvJ8iLCAi5o+Q56S6Iiwgew0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogIuehruWumiIsDQogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLA0KICAgICAgICB0eXBlOiAid2FybmluZyINCiAgICAgIH0pDQogICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRheGlvcw0KICAgICAgICAgICAgLmdldCgNCiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuaHR0cFVybCArDQogICAgICAgICAgICAgICAgIi9kZWxldGVPcmRlcj9pZD0iICsNCiAgICAgICAgICAgICAgICB0aGlzLm9yZGVyVGFibGVbaWRdLm9yZGVySWQNCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsNCiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMDAwKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLA0KICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIuWIoOmZpOaIkOWKn++8gSINCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICByb3dzLnNwbGljZShpZCwgMSk7DQogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwMDEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAi5Yig6Zmk5aSx6LSl77yM57O757uf6ZSZ6K+v77yBIg0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIHRoaXMuZ2V0T3JkZXIoKTsNCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuZGF0YS5jb2RlID09PSAyMDAwMSkgew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLliKDpmaTlpLHotKXvvIznmbvlvZXov4fmnJ/vvIzor7fph43mlrDnmbvlvZXvvIEiDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgdGhpcy5nZXRPcmRlcigpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIHR5cGU6ICJpbmZvIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLlt7Llj5bmtojliKDpmaQiDQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgZ2V0T3JkZXIoKSB7DQogICAgICBpZiAodGhpcy5vcmRlclRhYmxlKSB7DQogICAgICAgIHRoaXMub3JkZXJUYWJsZSA9IFtdOw0KICAgICAgfQ0KICAgICAgdGhpcy4kYXhpb3MNCiAgICAgICAgLmdldCh0aGlzLiRzdG9yZS5zdGF0ZS5odHRwVXJsICsgIi9nZXRPcmRlckFkbWluIikNCiAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7DQogICAgICAgICAgcmVzLmRhdGEuZGF0YS5mb3JFYWNoKGkgPT4gew0KICAgICAgICAgICAgaWYgKGkub3JkZXIub3JkZXJUeXBlID09IDEpIHsNCiAgICAgICAgICAgICAgdGhpcy5vcmRlclRhYmxlLnB1c2goew0KICAgICAgICAgICAgICAgIGlkOiAxLA0KICAgICAgICAgICAgICAgIG9yZGVySWQ6IGkub3JkZXIuaWQsDQogICAgICAgICAgICAgICAgdGltZToNCiAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKGkub3JkZXIub3JkZXJQYXlUaW1lKQ0KICAgICAgICAgICAgICAgICAgICAudG9Mb2NhbGVEYXRlU3RyaW5nKCkNCiAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1wvL2csICItIikgKw0KICAgICAgICAgICAgICAgICAgIiAiICsNCiAgICAgICAgICAgICAgICAgIG5ldyBEYXRlKGkub3JkZXIub3JkZXJQYXlUaW1lKS50b1RpbWVTdHJpbmcoKS5zdWJzdHIoMCwgOCksDQogICAgICAgICAgICAgICAgdGFibGU6IGkub3JkZXIub3JkZXJUYWJsZSwNCiAgICAgICAgICAgICAgICBzdGF0ZTogaS5vcmRlci5vcmRlclN0YXR1cywNCiAgICAgICAgICAgICAgICBvcmRlcjogaS5vcmRlci5pZCwNCiAgICAgICAgICAgICAgICBjdXN0b21lcjogaS5vcmRlci51c2VyTmFtZSwNCiAgICAgICAgICAgICAgICBjb3VudDogaS5vcmRlci5vcmRlckNvdW50T3JpZ2luYWwsDQogICAgICAgICAgICAgICAgZGlzY291bnQ6IGkub3JkZXIub3JkZXJDb3VudEFjdHVhbA0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKHJlcykgew0KICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7DQogICAgICAgIH0pOw0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmdldE9yZGVyKCk7DQogIH0NCn07DQo="},{"version":3,"sources":["order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"order.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div style=\"font-family:Franklin Gothic Medium;padding:25px 40px;\">\r\n    <div\r\n      style=\"box-shadow:0 0 3px 1px #ccc;background-color:#fff;padding:20px 0px;border-radius: 10px;\"\r\n    >\r\n      <div\r\n        style=\"padding:0px 20px;display:flex;align-items:center;margin-top: 5px;margin-bottom:30px;\"\r\n      >\r\n        <div style=\"margin-right:5px;\">\r\n          <i style=\"font-size:20px;\" class=\"el-icon-s-custom\"></i>\r\n        </div>\r\n        <div style=\"font-size: 16px;font-weight: 700;\">查看订单</div>\r\n      </div>\r\n      <hr\r\n        style=\"width:100%;color: rgb(236, 236, 236);border:none;border-top:2px solid;margin-bottom:25px;\"\r\n      />\r\n      <div style=\"margin-bottom:30px;padding:0px 20px;\">\r\n        <el-input style=\"width:250px;\" placeholder=\"请输入订单号\" v-model=\"order\" clearable></el-input>\r\n      </div>\r\n      <div style=\"padding:0px 20px;\">\r\n        <el-table row-key=\"orderId\" stripe :data=\"orderTable\" border style=\"width: 100%;\">\r\n          <el-table-column prop=\"time\" label=\"时间\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"order\" label=\"订单号\" align=\"center\" min-width=\"90px\"></el-table-column>\r\n          <el-table-column prop=\"customer\" label=\"顾客\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"table\" label=\"桌号\" align=\"center\" width=\"80px\"></el-table-column>\r\n          <el-table-column prop=\"count\" label=\"总价（元）\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"discount\" label=\"折后（元）\" align=\"center\"></el-table-column>\r\n          <el-table-column prop=\"state\" label=\"状态\" align=\"center\" width=\"130px\">\r\n            <template slot-scope=\"scope1\">\r\n              <div\r\n                v-if=\"orderTable[scope1.$index].state==1\"\r\n                style=\"color:#f56c6c;padding-right:20px;\"\r\n              >正在制作...</div>\r\n              <el-cascader\r\n                v-if=\"orderTable[scope1.$index].state!=1\"\r\n                @change=\"editState(scope1.$index)\"\r\n                v-model=\"orderTable[scope1.$index].state\"\r\n                :options=\"state\"\r\n              ></el-cascader>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column fixed=\"right\" label=\"操作\" align=\"center\" width=\"90px\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button\r\n                @click.prevent=\"deleteOrder(scope.$index, orderTable)\"\r\n                type=\"danger\"\r\n                size=\"mini\"\r\n              >删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      state: [\r\n        {\r\n          value: 2,\r\n          label: \"等待上菜\"\r\n        },\r\n        {\r\n          value: 3,\r\n          label: \"已完成\"\r\n        }\r\n      ],\r\n      order: \"\",\r\n      orderTable: []\r\n    };\r\n  },\r\n  methods: {\r\n    editState(id) {\r\n      this.$axios.defaults.headers.post[\"Content-Type\"] = \"application/json\";\r\n      this.$axios\r\n        .post(this.$store.state.httpUrl + \"/editOrderStatus\", {\r\n          orderStatus: parseInt(this.orderTable[id].state),\r\n          id: this.orderTable[id].orderId\r\n        })\r\n        .then(res => {\r\n          console.log(res.data);\r\n          if (res.data.code === 20000) {\r\n            this.$message({\r\n              type: \"success\",\r\n              message: \"修改状态成功！\"\r\n            });\r\n          } else if (res.data.code === 20001) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"修改状态失败，系统错误！\"\r\n            });\r\n            this.getMenu();\r\n          } else if (res.data.code === 20001) {\r\n            this.$message({\r\n              type: \"error\",\r\n              message: \"修改状态失败，登录过期，请重新登录！\"\r\n            });\r\n            this.getMenu();\r\n          }\r\n        });\r\n    },\r\n    deleteOrder(id, rows) {\r\n      this.$confirm(\"是否确定删除此订单？\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\"\r\n      })\r\n        .then(() => {\r\n          this.$axios\r\n            .get(\r\n              this.$store.state.httpUrl +\r\n                \"/deleteOrder?id=\" +\r\n                this.orderTable[id].orderId\r\n            )\r\n            .then(res => {\r\n              console.log(res.data);\r\n              if (res.data.code === 20000) {\r\n                this.dialogFormVisible = false;\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"删除成功！\"\r\n                });\r\n                rows.splice(id, 1);\r\n              } else if (res.data.code === 20001) {\r\n                this.$message({\r\n                  type: \"error\",\r\n                  message: \"删除失败，系统错误！\"\r\n                });\r\n                this.getOrder();\r\n              } else if (res.data.code === 20001) {\r\n                this.$message({\r\n                  type: \"error\",\r\n                  message: \"删除失败，登录过期，请重新登录！\"\r\n                });\r\n                this.getOrder();\r\n              }\r\n            });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"已取消删除\"\r\n          });\r\n        });\r\n    },\r\n    getOrder() {\r\n      if (this.orderTable) {\r\n        this.orderTable = [];\r\n      }\r\n      this.$axios\r\n        .get(this.$store.state.httpUrl + \"/getOrderAdmin\")\r\n        .then(res => {\r\n          console.log(res.data);\r\n          res.data.data.forEach(i => {\r\n            if (i.order.orderType == 1) {\r\n              this.orderTable.push({\r\n                id: 1,\r\n                orderId: i.order.id,\r\n                time:\r\n                  new Date(i.order.orderPayTime)\r\n                    .toLocaleDateString()\r\n                    .replace(/\\//g, \"-\") +\r\n                  \" \" +\r\n                  new Date(i.order.orderPayTime).toTimeString().substr(0, 8),\r\n                table: i.order.orderTable,\r\n                state: i.order.orderStatus,\r\n                order: i.order.id,\r\n                customer: i.order.userName,\r\n                count: i.order.orderCountOriginal,\r\n                discount: i.order.orderCountActual\r\n              });\r\n            }\r\n          });\r\n        })\r\n        .catch(function(res) {\r\n          console.log(res);\r\n        });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getOrder();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n</style>"]}]}